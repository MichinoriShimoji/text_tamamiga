<!DOCTYPE html>
<html lang="ja"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InTEx: Interactive TExt gallery </title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            margin: 0;
            padding: 40px 20px;
            background: #fafafa;
            min-height: 100vh;
            color: #222;
            line-height: 1.7;
        }
        
        .container {
            max-width: 860px;
            margin: 0 auto;
            background: #fff;
            padding: 50px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        
        h1 {
            color: #111;
            text-align: center;
            margin-bottom: 8px;
            font-size: 24px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 16px;
            font-size: 14px;
        }
        
            text-align: center;
            margin-bottom: 40px;
        }
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #333;
            text-decoration: none;
            font-weight: 500;
            font-size: 13px;
            padding: 10px 20px;
            background: #fff;
            border-radius: 4px;
            transition: all 0.2s ease;
            border: 1px solid #ddd;
        }
            border-color: #c00;
            color: #c00;
        }
            content: 'â–¶';
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            background: #c00;
            color: #fff;
            border-radius: 4px;
            font-size: 10px;
            padding-left: 2px;
        }
        
        /* ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .upload-section {
            background: #fff;
            border: 1px solid #e0e0e0;
            padding: 32px;
            border-radius: 4px;
            margin-bottom: 32px;
        }
        
        .upload-section h2 {
            color: #111;
            margin-top: 0;
            margin-bottom: 24px;
            font-size: 16px;
            font-weight: 600;
            padding-bottom: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .upload-group {
            margin-bottom: 24px;
        }
        
        .upload-label {
            display: block;
            font-weight: 500;
            margin-bottom: 8px;
            color: #333;
            font-size: 13px;
        }
        
        .file-input, .text-input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            background-color: #fff;
            color: #222;
            transition: border-color 0.2s;
        }
        
        .file-input:hover, .text-input:hover,
        .file-input:focus, .text-input:focus {
            border-color: #999;
            outline: none;
        }
        
        .file-input::file-selector-button {
            background: #333;
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 13px;
            cursor: pointer;
            margin-right: 12px;
            transition: background 0.2s;
        }
        
        .file-input::file-selector-button:hover {
            background: #111;
        }
        
        .process-button {
            background: #111;
            color: #fff;
            border: none;
            padding: 14px 48px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            display: block;
            margin: 32px auto 0;
            transition: all 0.2s ease;
        }
        
        .process-button:hover:not(:disabled) {
            background: #333;
        }
        
        .process-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .content-section {
            display: none;
        }
        
        .gloss-info-banner {
            background: #f8f8f8;
            border-left: 3px solid #333;
            padding: 14px 18px;
            margin-bottom: 24px;
            font-size: 13px;
            color: #555;
        }
        
        .gloss-info-banner strong {
            color: #222;
        }
        
        .gloss-info-banner a {
            color: #333;
            text-decoration: underline;
        }
        
        .status-bar {
            background: #f8f8f8;
            padding: 14px 18px;
            border-radius: 4px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }
        
        .status-info {
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-info span {
            color: #111;
            font-weight: 600;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #333;
        }
        
        /* é€£ç¶šå†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */
        .playback-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 32px;
            gap: 12px;
        }
        
        .play-all-button, .download-button {
            background: #fff;
            color: #333;
            border: 1px solid #ddd;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
        }
        
        .play-all-button:hover, .download-button:hover {
            border-color: #333;
            background: #333;
            color: #fff;
        }
        
        .play-all-button.playing {
            background: #333;
            color: #fff;
            border-color: #333;
        }
        
        .play-all-button .button-icon, .download-button .button-icon {
            font-size: 14px;
        }
        
        /* ä¾‹æ–‡ãƒªã‚¹ãƒˆ */
        .example-list {
            margin-top: 24px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .example-list::-webkit-scrollbar {
            width: 6px;
        }
        
        .example-list::-webkit-scrollbar-track {
            background: #f0f0f0;
        }
        
        .example-list::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }
        
        .example-item {
            margin: 0;
            padding: 20px 24px;
            background: #fff;
            cursor: pointer;
            transition: background 0.2s ease;
            border-bottom: 1px solid #eee;
            position: relative;
        }
        
        .example-item:first-child {
            border-top: 1px solid #eee;
        }
        
        .example-item:hover {
            background: #f8f8f8;
        }
        
        .example-item.playing {
            background: #f0f0f0;
        }
        
        .example-number {
            font-weight: 600;
            color: #333;
            margin-right: 12px;
            font-size: 14px;
        }
        
        .interlinear-container {
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
            line-height: 1.8;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .interlinear-row {
            display: flex;
            align-items: flex-start;
            gap: 0.5em;
        }
        
        .word-group {
            display: inline-flex;
            flex-direction: column;
            align-items: flex-start;
            margin-right: 0.5em;
        }
        
        .original-word {
            font-size: 16px;
            color: #111;
            font-weight: 500;
            font-family: Georgia, 'Times New Roman', serif;
        }
        
        .gloss-word {
            font-size: 13px;
            color: #666;
            font-variant: small-caps;
            font-family: 'Courier New', monospace;
        }
        
        .gloss-clickable {
            cursor: pointer;
            text-decoration: underline;
            text-decoration-style: dotted;
            text-underline-offset: 2px;
            color: #333;
            font-weight: 600;
            transition: color 0.2s ease;
        }
        
        .gloss-clickable:hover {
            color: #000;
        }
        
        .translation-text {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            white-space: normal;
        }
        
        .play-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        
        .example-item:hover .play-icon {
            background: #333;
            color: #fff;
        }
        
        .example-item.playing .play-icon {
            background: #333;
            color: #fff;
        }
        
        /* ã‚°ãƒ­ã‚¹å¹ãå‡ºã— */
        .gloss-tooltip {
            position: fixed;
            background: #111;
            color: #fff;
            padding: 12px 16px;
            border-radius: 4px;
            font-size: 13px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            max-width: 280px;
            opacity: 0;
            transform: translateY(-8px);
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
        }
        
        .gloss-tooltip.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .gloss-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #111 transparent transparent transparent;
        }
        
        .gloss-tooltip-title {
            font-weight: 600;
            color: #fff;
            margin-bottom: 4px;
        }
        
        /* ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ */
        #audioPlayer {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: #111;
            padding: 16px 24px;
            border-radius: 4px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: none;
            align-items: center;
            gap: 16px;
            color: #fff;
            font-size: 13px;
        }
        
        #audioPlayer.active {
            display: flex;
        }
        
        .audio-progress {
            width: 160px;
            height: 4px;
            background-color: #444;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .audio-progress-bar {
            height: 100%;
            background: #fff;
            width: 0%;
            transition: width 0.1s linear;
        }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .status-message {
            margin-top: 16px;
            padding: 12px 16px;
            border-radius: 4px;
            font-size: 13px;
            text-align: center;
            display: none;
        }
        
        .status-message.info {
            background: #f0f0f0;
            color: #333;
            display: block;
        }
        
        .status-message.success {
            background: #f0f0f0;
            color: #333;
            display: block;
        }
        
        .status-message.error {
            background: #fef2f2;
            color: #991b1b;
            display: block;
        }
        
        /* Zenodoå–å¾—æ©Ÿèƒ½ */
        .zenodo-section {
            margin-top: 12px;
            padding: 18px;
            background: #f8f8f8;
            border-radius: 4px;
        }
        .zenodo-section label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
            font-weight: 500;
        }
        .zenodo-row {
            display: flex;
            gap: 8px;
        }
        .zenodo-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
            background: #fff;
            color: #222;
            transition: border-color 0.2s;
        }
        .zenodo-input:focus {
            outline: none;
            border-color: #999;
        }
        .zenodo-input::placeholder {
            color: #aaa;
        }
        .zenodo-btn {
            padding: 10px 20px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            transition: background 0.2s;
        }
        .zenodo-btn:hover {
            background: #111;
        }
        .zenodo-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .zenodo-status {
            font-size: 12px;
            margin-top: 10px;
            color: #666;
        }
        .zenodo-status.success {
            color: #166534;
        }
        .zenodo-status.error {
            color: #991b1b;
        }
        .manual-url-section {
            margin-top: 18px;
            padding-top: 18px;
            border-top: 1px solid #e0e0e0;
        }
        .manual-url-section label {
            color: #888 !important;
        }
        .manual-url-textarea {
            width: 100%;
            height: 100px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
            resize: vertical;
            background: #fff;
            color: #222;
            transition: border-color 0.2s;
        }
        .manual-url-textarea:focus {
            outline: none;
            border-color: #999;
        }
        .manual-url-textarea::placeholder {
            color: #aaa;
        }
        .manual-url-count {
            font-size: 12px;
            color: #888;
            margin-top: 8px;
        }
        .manual-url-count.has-urls {
            color: #166534;
        }
        
        /* small text */
        small {
            color: #888 !important;
            font-size: 12px;
        }
        
        audio {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="pageTitle">ãƒŒãƒ¼ã‚·å¾¡å¶½ã®ã‚¿ãƒãƒŸã‚¬</h1>
        <div class="subtitle" id="pageSubtitle">å®®å¤èªä¼Šè‰¯éƒ¨é•·æµœæ–¹è¨€</div>
        
        
        
        <!-- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        
        
        <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="content-section" id="contentSection" style="display: block;">
            <div class="gloss-info-banner">
                <strong>ã‚°ãƒ­ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å’Œè¨³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</strong>
                ï¼ˆ<a href="https://michinorishimoji.github.io/searchgloss/" target="_blank">SearchGloss</a>ã«åŸºã¥ãã‚°ãƒ­ã‚¹è¾æ›¸ã‚’å†…è”µï¼‰
            </div>
            
            <div class="status-bar">
                <div class="status-info">
                    <div class="status-indicator"></div>
                    ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <span id="statusText">æº–å‚™å®Œäº†</span>
                </div>
                <div class="status-info">
                    ä¾‹æ–‡æ•°: <span id="exampleCount">54</span>
                </div>
            </div>
            
            <div class="playback-controls">
                <button id="playAllBtn" class="play-all-button" style="display: flex;">
                    <span class="button-icon">â–¶</span>
                    <span class="button-text">å…¨ä½“éŸ³å£°ã‚’å†ç”Ÿ</span>
                </button>
                <button id="downloadBtn" class="download-button">
                    <span class="button-icon">â¬‡</span>
                    <span class="button-text">HTMLã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</span>
                </button>
            </div>
            
            <div class="example-list" id="exampleList"></div>
        </div>
        
        <!-- ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ -->
        <div id="audioPlayer">
            <span>å†ç”Ÿä¸­ï¼š</span>
            <span id="currentExample"></span>
            <div class="audio-progress">
                <div class="audio-progress-bar" id="progressBar"></div>
            </div>
        </div>
        
        <audio id="audio" crossorigin="anonymous"></audio>
        
        <!-- ã‚°ãƒ­ã‚¹å¹ãå‡ºã— -->
        <div class="gloss-tooltip" id="glossTooltip">
            <div class="gloss-tooltip-content">
                <div class="gloss-tooltip-title" id="glossTitle"></div>
                <div id="glossDescription"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
                    // åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿
                    window.embeddedData = {
                        examples: [{"id":1,"original":"nkjaan=ca.","gloss":"æ˜”=HS","japanese":"æ˜”ã€…ã®ã“ã¨ã ã¨ã•"},{"id":2,"original":"nkjaan=du anna=tu uja=tu tamamiga=ti asÉ¨ ffa-gama=nu u-tar=ca.","gloss":"æ˜”=FOC æ¯è¦ª=COM çˆ¶è¦ª=COM ã‚¿ãƒãƒŸã‚¬=QUOT ã„ã† å­-DIM=NOM ã„ã‚‹-PST=HS","japanese":"æ˜”ã€…ã€æ¯è¦ªã¨çˆ¶è¦ªã¨ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†å­ãŒã„ãŸã‚“ã ã£ã¦ã€‚"},{"id":3,"original":"unu ffa-gama dondon dondon aparagi-midum-masii sudacii","gloss":"ãã® å­-DIM ã©ã‚“ã©ã‚“ ã©ã‚“ã©ã‚“ ç¾ã—ã„-å¥³-ã«ãªã£ã¦ è‚²ã£ã¦","japanese":"ãã®å­ã¯ã©ã‚“ã©ã‚“ã©ã‚“ã©ã‚“ç¶ºéº—ãªå¥³ã«è‚²ã£ã¦"},{"id":4,"original":"mura=kara=mai icÉ¨ban aparagi-munu=nu mmja uu-fÉ¨ nar-i-i nar-i-u-tar=ca.","gloss":"æ‘=ABL=ADD ä¸€ç•ª ç¾ã—ã„-ADJ=NOM DSC å¤§ãã„-SEQ ãªã‚‹-THM-SEQ ãªã‚‹-THM-PROG-PST=HS","japanese":"æ‘ã§ã‚‚ä¸€ç•ªã®ç¾äººã«ãªã£ã¦ã„ã£ãŸã‚“ã ã¨ã•ã€‚"},{"id":5,"original":"unu otoo=ga dekasegi=nkai ik-i-i","gloss":"ãã® çˆ¶è¦ª=NOM å‡ºç¨¼ã=ALL è¡Œã-THM-SEQ","japanese":"çˆ¶è¦ªãŒå‡ºç¨¼ãã«è¡Œã£ã¦"},{"id":6,"original":"tuusa=nu jaejama=atari=nkai enjoogjogjoo=nkai ik-i-i","gloss":"é ã=GEN å…«é‡å±±=APRX=ALL é æ´‹æ¼æ¥­=ALL è¡Œã-THM-SEQ","japanese":"é ãã€å…«é‡å±±ã‚ãŸã‚Šã«é æ´‹æ¼æ¥­ã«è¡Œã£ã¦"},{"id":7,"original":"nannici=mai fÉ¨ni=n nuur-i-i utui-i","gloss":"ä½•æ—¥=ADD èˆ¹=DAT ä¹—ã‚‹-THM-SEQ CRCM-SEQ","japanese":"ä½•æ—¥ã‚‚èˆ¹ã«ä¹—ã£ã¦ã„ã¦"},{"id":8,"original":"jaa=nkai fÉ¨É¨-gumata=ti=nu tukja=n","gloss":"å®¶=ALL æ¥ã‚‹-FUT=QUOT=GEN æ™‚=DAT","japanese":"å®¶ã«å¸°ã£ã¦ãã‚‹ã¨ã„ã†æ™‚"},{"id":9,"original":"tamamiga=a ttigaa otoo=ju=baa tuuf=fa cÉ¨ff-i-i","gloss":"ã‚¿ãƒãƒŸã‚¬=TOP ãã—ãŸã‚‰ çˆ¶è¦ª=ACC=OTOP è±†è…=ACC2 ä½œã‚‹-THM-SEQ","japanese":"ã‚¿ãƒãƒŸã‚¬ã¯ã€ã€Œãã—ãŸã‚‰ãŠçˆ¶ã•ã‚“ã«è±†è…ã‚’ä½œã£ã¦ã€"},{"id":10,"original":"nkjaan=du tuufÉ¨=nu=du gocisoo a-taiba","gloss":"æ˜”=FOC è±†è…=NOM=FOC ã”é¦³èµ° COP-PST.CSL","japanese":"æ˜”ã¯è±†è…ãŒã”é¦³èµ°ã ã£ãŸã‹ã‚‰ã­"},{"id":11,"original":"tuuf=fa cÉ¨ff-i-i utui-i otoo nn mukai-di=ti","gloss":"è±†è…=ACC2 ä½œã‚‹-THM-SEQ CRCM-SEQ çˆ¶è¦ª FIL è¿ãˆã‚‹-INT=QUOT","japanese":"ã€Œè±†è…ã‚’ä½œã£ã¦ãŠã„ã¦ãŠçˆ¶ã•ã‚“ã‚’è¿ãˆã‚ˆã†ã€ã¨"},{"id":12,"original":"tuufÉ¨ tuufÉ¨=nu ukusu ukusumizÉ¨ nigari=nu kawari=n=du ukusumic=cu fÉ¨m-i-taiba","gloss":"è±†è… è±†è…=GEN æµ·æ°´ æµ·æ°´ ãƒ‹ã‚¬ãƒª=GEN ä»£ã‚ã‚Š=DAT=FOC æµ·æ°´=ACC æ±²ã‚€-THM-PST.CSL","japanese":"è±†è…ã®ï¼ˆãƒ‹ã‚¬ãƒªã«ãªã‚‹ï¼‰æµ·æ°´ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã€‚ï¼ˆæ˜”ã¯ï¼‰ãƒ‹ã‚¬ãƒªã®ä»£ã‚ã‚Šã«æµ·æ°´ã‚’æ±²ã‚“ã ã‚‚ã®ã ã‹ã‚‰ã€‚"},{"id":13,"original":"tagu=u muc-i-i=i","gloss":"æ¡¶=ACC æŒã¤-THM-SEQ=CNF","japanese":"æ¡¶ã‚’æŒã£ã¦"},{"id":14,"original":"ukusu-mizÉ¨ fÉ¨m=tii ifÉ¨-tar=ca.","gloss":"æµ·æ°´-æ°´ æ±²ã‚€=QUOT è¡Œã-PST=HS","japanese":"æµ·æ°´ã‚’æ±²ã¿ã«è¡Œã£ãŸã‚“ã ã¨ã•ã€‚"},{"id":15,"original":"unu tuki-nagi=n=na","gloss":"ãã® æ™‚-APRX=DAT=TOP","japanese":"ãã®å½“æ™‚ã¯"},{"id":16,"original":"anu bizin=nu aparagi-pÅ¾tu=nkai=ja","gloss":"FIL ç¾äºº=GEN ç¾ã—ã„-äºº=ALL=TOP","japanese":"ç¾äººã®äººã«"},{"id":17,"original":"ironna bjooki=kara mamono=kara=ti tu-i-i inuci=u tur-i-i par pÅ¾tu=nu tukja=n=na","gloss":"ã„ã‚ã‚“ãª ç—…æ°—=ABL é­”ç‰©=ABL=QUOT å–ã‚‹-THM-SEQ å‘½=ACC å–ã‚‹-THM-SEQ è¡Œã äºº=GEN æ™‚=DAT=TOP","japanese":"ã„ã‚ã‚“ãªç—…æ°—ã‚„ã‚‰é­”ç‰©ã‚„ã‚‰å‘½ã‚’ã¨ã£ã¦ã„ãã‚„ã¤ãŒã„ã‚‹æ™‚ã¯"},{"id":18,"original":"majoke=nu tame=n=du sÉ¨mi=u hitai=nkai hitai=nkai sÉ¨mi=u nur=tame=n","gloss":"é­”é™¤ã‘=GEN ãŸã‚=DAT=FOC ç‚­=ACC é¡=ALL é¡=ALL ç‚­=ACC å¡—ã‚‹=ãŸã‚=DAT","japanese":"é­”é™¤ã‘ã®ãŸã‚ã«ç‚­ã‚’ã­ã€é¡ã«ç‚­ã‚’å¡—ã‚‹ãŸã‚ã«"},{"id":19,"original":"nabi=nu ffusÉ¨É¨","gloss":"é‹=GEN ã™ã™","japanese":"é‹ã®ã™ã™"},{"id":20,"original":"nabi=nu sÉ¨mi ffusÉ¨É¨=ju","gloss":"é‹=GEN ã™ã™ ACC=","japanese":"é‹ã®ç‚­ã­ã€ã™ã™ã‚’"},{"id":21,"original":"hitai=nkai cÉ¨ki-i=kara icÉ¨gu maar-i-u-tar=ca.","gloss":"é¡=ALL ã¤ã‘ã‚‹-SEQ=ANT ã„ã¤ã‚‚ ã¾ã‚ã‚‹-THM-PROG-PST=HS","japanese":"é¡ã«ã¤ã‘ã¦ã‹ã‚‰ã„ã¤ã‚‚å‡ºã‹ã‘ã¦ã„ãŸã‚“ã ã£ã¦ã€‚"},{"id":22,"original":"aparagi-ka-i-ba tur-ai-zjaan=tii","gloss":"ç¾ã—ã„-VLZ-THM-CSL å–ã‚‹-PASS-NEG.INT=QUOT","japanese":"ç¾äººã ã‹ã‚‰ã€ï¼ˆé­”ç‰©ã«ï¼‰æ”«ã‚ã‚Œãªã„ã‚ˆã†ã«ã£ã¦ã­ã€‚"},{"id":23,"original":"dakedo unu pÅ¾Å¾=n=na mmja bassi-i uri=u","gloss":"ã ã‘ã© ãã® æ—¥=DAT=TOP DSC å¿˜ã‚Œã‚‹-SEQ ãã‚Œ=ACC","japanese":"ã ã‘ã©ã€ãã®æ—¥ã¯å¿˜ã‚Œã¦ã­ã€ãã‚Œã‚’ã€‚"},{"id":24,"original":"mmja tagu=u mucii mmja im=nu pama=nkai ifÉ¨-tar=ca.","gloss":"DSC æ¡¶=ACC æŒã£ã¦ DSC æµ·=GEN æµœ=ALL è¡Œã-PST=HS","japanese":"æ¡¶ã‚’æŒã£ã¦æµ·ã®æµœã«è¡Œã£ãŸã‚“ã ã£ã¦ã€‚ä¼Šè‰¯éƒ¨ã®æµœã«ã€‚"},{"id":25,"original":"irav=nu pama=nkai.","gloss":"ä¼Šè‰¯éƒ¨=GEN æµœ=ALL","japanese":"æ¡¶ã‚’æŒã£ã¦æµ·ã®æµœã«è¡Œã£ãŸã‚“ã ã£ã¦ã€‚ä¼Šè‰¯éƒ¨ã®æµœã«ã€‚"},{"id":26,"original":"asi mmja kjuu=ja mmja paikazi-gama-as-i-i-ba","gloss":"ã•ã¦ DSC ä»Šæ—¥=TOP DSC å—é¢¨-DIM-CVLZ-THM-SEQ-CSL","japanese":"ã•ã¦ã€ä»Šæ—¥ã¯å—é¢¨ã ã‹ã‚‰"},{"id":27,"original":"otoo=ga fÉ¨ni=nu=du fÉ¨É¨=ti","gloss":"çˆ¶è¦ª=GEN èˆ¹=NOM=FOC æ¥ã‚‹=QUOT","japanese":"ãŠçˆ¶ã•ã‚“ã®èˆ¹ãŒæ¥ã‚‹ãã€ã¨"},{"id":28,"original":"mmja uri=u pukarassa-as-i-i uri=u macÉ¨kani-gacÉ¨na","gloss":"DSC 3SG=ACC å¬‰ã—ã•-CVLZ-THM-SEQ 3SG=ACC å¾…ã¡ã‹ã­ã‚‹-SIM","japanese":"ã‚¦ã‚­ã‚¦ã‚­ã—ã¦å¾…ã¡ã‹ã­ãªãŒã‚‰"},{"id":29,"original":"ukusu-mizÉ¨ fÉ¨m-i-ur aida=n=du","gloss":"æµ·æ°´-æ°´ æ±²ã‚€-THM-PROG é–“=DAT=FOC","japanese":"æµ·æ°´ã‚’æ±²ã‚“ã§ã„ã‚‹é–“ã«"},{"id":30,"original":"nzagagara=kara mmja mamunu=nu idi-i ccii mmja","gloss":"ã©ã“ã‹=ABL DSC é­”ç‰©=NOM å‡ºã‚‹-SEQ æ¥ã‚‹.SEQ DSC","japanese":"ã©ã“ã‹ã‚‰ã‹é­”ç‰©ãŒå‡ºã¦ãã¦"},{"id":31,"original":"tamamiga=u mmja sara-i-i par-tar=ca.","gloss":"ã‚¿ãƒãƒŸã‚¬=ACC DSC ã•ã‚‰ã†-THM-SEQ è¡Œã-PST=HS","japanese":"ã‚¿ãƒãƒŸã‚¬ã‚’ã•ã‚‰ã£ã¦è¡Œã£ãŸã‚“ã ã£ã¦ã€‚"},{"id":32,"original":"sara-i-i ik-i-i mmja uma=nu acca=nu uku-muri=nu a-i-ba","gloss":"ã•ã‚‰ã†-THM-SEQ DSC è¡Œã-THM-SEQ ãã“=GEN ãã°=GEN å¤§ãã„-æ£®=NOM ã‚ã‚‹-THM-CSL","japanese":"ã•ã‚‰ã£ã¦è¡Œã£ã¦ã€å‘ã“ã†ã«å¤§ãã„æ£®ãŒã‚ã‚‹ã‹ã‚‰"},{"id":33,"original":"uma=nkai-jas-i-i mmja kaffi-i par..","gloss":"ãã“=ALL-CVLZ-THM-SEQ DSC éš ã‚Œã‚‹-SEQ é€£ã‚Œã¦ã„ã","japanese":"ãã“ã¸éš ã‚Œã¦æ¶ˆãˆãŸã‚“ã ã£ã¦ã€‚"},{"id":34,"original":"saar-i-i par-tar=ca.","gloss":"THM-SEQ-è¡Œã PST-HS=","japanese":"ãã“ã¸éš ã‚Œã¦æ¶ˆãˆãŸã‚“ã ã£ã¦ã€‚"},{"id":35,"original":"asi icÉ¨=gami=mai jaa=nkai kuun=siba anna=ga","gloss":"ã•ã¦ ã„ã¤=LMT=ADD å®¶=ALL æ¥ã‚‹.NEG=CSL æ¯è¦ª=NOM","japanese":"ã•ã¦ã€ã„ã¤ã¾ã§ã‚‚å®¶ã«æ¥ãªã„ã‚‚ã®ã ã‹ã‚‰ã€æ¯è¦ªãŒ"},{"id":36,"original":"tamamiga tamamiga=ti uma-nagi tumir-i-ba=mai mii-n.","gloss":"ã‚¿ãƒãƒŸã‚¬ ã‚¿ãƒãƒŸã‚¬=QUOT ãã“-APRX æ¢ã™-THM-COND=ADD ã„ã‚‹-NEG","japanese":"ã‚¿ãƒãƒŸã‚¬ãƒ¼ï¼ã‚¿ãƒãƒŸã‚¬ãƒ¼ï¼ã¨ã‚ã¡ã“ã¡æ¢ã—ã¦ã‚‚ã„ãªã„ã€‚"},{"id":37,"original":"tamamiga tamamiga=ti hama=gami fÉ¨É¨-tigaa","gloss":"ã‚¿ãƒãƒŸã‚¬ ã‚¿ãƒãƒŸã‚¬=QUOT æµœ=LMT æ¥ã‚‹-COND","japanese":"ã‚¿ãƒãƒŸã‚¬ãƒ¼ï¼ã‚¿ãƒãƒŸã‚¬ãƒ¼ï¼ã¨è¨€ã„ãªãŒã‚‰æµœã¾ã§æ¥ãŸã‚‰"},{"id":38,"original":"unu pama=n tagu=nu mmja nagir-ai-i","gloss":"ãã® æµœ=DAT æ¡¶=NOM DSC æ¨ã¦ã‚‹-PASS-SEQ","japanese":"æµœã«æ¡¶ãŒæ¨ã¦ã‚‰ã‚Œã¦ã„ã¦"},{"id":39,"original":"taru=u cumma mii-n=siba","gloss":"èª°=TOP EVEN ã„ã‚‹-NEG=CSL","japanese":"èª°ã‚‚ã„ãªã„ã‹ã‚‰"},{"id":40,"original":"agai tamamiga=jooi=ti uma-nagi tumir-i-ba=mai kuu-n.","gloss":"ã‚ã‚ ã‚¿ãƒãƒŸã‚¬=VOC=QUOT ãã“-APRX æ¢ã™-THM-COND=ADD æ¥ã‚‹-NEG","japanese":"ã€Œã‚ã‚ã€ã‚¿ãƒãƒŸã‚¬ã‚ˆï¼ã€ã¨ã‚ã¡ã“ã¡æ¢ã—ã¦ã‚‚æ¥ãªã„ã€‚"},{"id":41,"original":"nacÉ¨=n=na nak-i-i nannici=mai nacÉ¨=n=na nak-i-i","gloss":"æ³£ã.INF=DAT=TOP æ³£ã-THM-SEQ ä½•æ—¥=ADD æ³£ã.INF=DAT=TOP æ³£ã-THM-SEQ","japanese":"æ³£ãã«æ³£ã„ã¦ã€ä½•æ—¥ã‚‚æ³£ãã«æ³£ã„ã¦"},{"id":42,"original":"nivv-i-ur-tigaa","gloss":"å¯ã‚‹-THM-PROG-COND","japanese":"ï¼ˆã‚ã‚‹æ™©ï¼‰å¯ã¦ã„ãŸã‚‰"},{"id":43,"original":"mmja jume=nu naka=n","gloss":"DSC å¤¢=GEN ä¸­=DAT","japanese":"å¤¢ã®ä¸­ã«"},{"id":44,"original":"hai anna icÉ¨=gami=mai ai kanasÉ¨m-na.","gloss":"VOC ãŠæ¯ã•ã‚“ ã„ã¤=LMT=ADD ãã‚“ãª æ‚²ã—ã‚€-PROH","japanese":"ã€ŒãŠæ¯ã•ã‚“ï¼ã„ã¤ã¾ã§ã‚‚ãã‚“ãªã«æ‚²ã—ã¾ãªã„ã§ã€‚æ³£ã‹ãªã„ã§ã€‚ã€"},{"id":45,"original":"nak-i-ur-na.","gloss":"æ³£ã-THM-PROG-PROH","japanese":"ã€ŒãŠæ¯ã•ã‚“ï¼ã„ã¤ã¾ã§ã‚‚ãã‚“ãªã«æ‚²ã—ã¾ãªã„ã§ã€‚æ³£ã‹ãªã„ã§ã€‚ã€"},{"id":46,"original":"nara=a uma=nu nuusiutaki=nu nusÉ¨=n=du tur-ai-i nuusiutaki=n..","gloss":"REFL=TOP ãã“=GEN ãƒŒãƒ¼ã‚·å¾¡å¶½=GEN ä¸»=DAT=FOC ã¨ã‚‰ãˆã‚‹-PASS-SEQ ãƒŒãƒ¼ã‚·å¾¡å¶½=DAT","japanese":"ã€Œç§ã¯ãã“ã®ãƒŒãƒ¼ã‚·å¾¡å¶½ã®ä¸»ã«ã¨ã‚‰ã‚ã‚Œã¦ã€ãƒŒãƒ¼ã‚·å¾¡å¶½ã®ç¥æ§˜ã«ãªã£ã¦ã„ã¾ã™ã‹ã‚‰ã€"},{"id":47,"original":"=nu kamisama=n nar-i-i uma=n u-i-ba","gloss":"=GEN ç¥æ§˜=DAT ãªã‚‹-THM-SEQ ãã“=DAT ã„ã‚‹-THM-CSL","japanese":"ã€Œç§ã¯ãã“ã®ãƒŒãƒ¼ã‚·å¾¡å¶½ã®ä¸»ã«ã¨ã‚‰ã‚ã‚Œã¦ã€ãƒŒãƒ¼ã‚·å¾¡å¶½ã®ç¥æ§˜ã«ãªã£ã¦ã„ã¾ã™ã‹ã‚‰ã€"},{"id":48,"original":"mmja nara=ga kutu=ba mmja sjuwa=sÉ¨-da ur-i=tii ass-i-i mmja jume=kara sami-tar=ca.","gloss":"DSC REFL=GEN ã“ã¨=OTOP DSC å¿ƒé…=ã™ã‚‹-NEG.SEQ PROG-IMP=QUOT è¨€ã†-THM-SEQ DSC å¤¢=ABL è¦šã‚ã‚‹-PST=HS","japanese":"ã€Œç§ã®ã“ã¨ã¯å¿ƒé…ã—ãªã„ã§ã„ã¦ãã ã•ã„ã€ã¨è¨€ã£ã¦ã€ï¼ˆæ¯è¦ªã¯ï¼‰å¤¢ã‹ã‚‰è¦šã‚ãŸã‚“ã ã£ã¦ã€‚"},{"id":49,"original":"agai, uma=nu kamisama=n=du nar-i-ur=gajuukam=ti ik-i-i mmja un=kara","gloss":"INTJ ãã“=GEN ç¥æ§˜=DAT=FOC ãªã‚‹-THM-PROG=SML=QUOT è¡Œã-THM-SEQ DSC ãã®ã¨ã=ABL","japanese":"ã€ŒãŠãŠã€ãã“ã®ç¥æ§˜ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã ã€ã¨ï¼ˆæ¯è¦ªã¯ï¼‰è¡Œã£ã¦ã€ãã®æ™‚ã‹ã‚‰"},{"id":50,"original":"uma=n ik-i-i mmja kam=ma niga-i mmja","gloss":"ãã“=DAT è¡Œã-THM-SEQ DSC ç¥æ§˜=ACC2 é¡˜ã†-THM DSC","japanese":"ï¼ˆã¿ã‚“ãªã§ï¼‰ãã“ã«è¡Œã£ã¦ã€ç¥é¡˜ã„ã—ã¦"},{"id":51,"original":"kamisama=nu mmi=nkai zjautuu=nu mamurigamisama=n nar-i=joo=ti","gloss":"ç¥æ§˜=GEN ç¾¤ã‚Œ=ALL ç´ æ™´ã‚‰ã—ã„=GEN å®ˆã‚Šç¥=DAT ãªã‚‹-IMP=VOC=QUOT","japanese":"ç¥ã€…ã«ã€ç´ æ™´ã‚‰ã—ã„å®ˆã‚Šç¥ã«ãªã‚Šãªã•ã„ã‚ˆã€ã¨"},{"id":52,"original":"mmna=sii kam=ma niga-i","gloss":"ã¿ã‚“ãª=INS ç¥=ACC2 é¡˜ã†-THM","japanese":"ã¿ã‚“ãªã§ç¥é¡˜ã„ã—ã¦"},{"id":53,"original":"un=kara uma=nu nuusiutaki=u=baa tamamiga nuusiutaki=nu tamamiga=ti=nu pÅ¾tu=nu macÉ¨r-i-i mmja uma=a utaki=tii takasa-as-i-i","gloss":"ãã®æ™‚=ABL ãã“=GEN ãƒŒãƒ¼ã‚·å¾¡å¶½=ACC=OTOP ã‚¿ãƒãƒŸã‚¬...ãƒŒãƒ¼ã‚·å¾¡å¶½ GEN=ã‚¿ãƒãƒŸã‚¬ QUOT=GEN=äºº GEN=å´‡ã‚ã‚‹ THM-SEQ-DSC ãã“ TOP=å¾¡å¶½ QUOT=å´‡ã‚ CVLZ-THM-SEQ-","japanese":"ãã®æ™‚ã‹ã‚‰ã€ãã®ï¼ˆä»Šæˆ‘ã€…ãŒï¼‰ãƒŒãƒ¼ã‚·å¾¡å¶½ï¼ˆã¨å‘¼ã¶ãã®å ´æ‰€ï¼‰ã¯ã‚¿ãƒãƒŸã‚¬ã¨ã„ã†äººãŒç¥€ã‚‰ã‚Œã¦ã„ã‚‹ã®ã ã¨ä¿¡ã˜ã‚‰ã‚Œã€ãã“ã‚’å¾¡å¶½ã¨ã—ã¦å´‡ã‚"},{"id":54,"original":"kamnigai=u icÉ¨gu as-i-ur=ri.","gloss":"ç¥é¡˜ã„=ACC ã„ã¤ã‚‚ ã™ã‚‹-THM-PROG=CNF","japanese":"ç¥é¡˜ã„ã‚’ã„ã¤ã‚‚ã—ã¦ã„ã‚‹ã‚“ã ã‚ˆã€‚"}],
                        audioUrls: ["https://zenodo.org/api/records/16753649/files/001_nkjaanca.wav/content?download=1","https://zenodo.org/api/records/16753649/files/002_nkjaandu_annatu_ujatu_tamam.wav/content?download=1","https://zenodo.org/api/records/16753649/files/003_unu_ffa-gama_dondon_dondon_apa.wav/content?download=1","https://zenodo.org/api/records/16753649/files/004_murakaramai_icÉ¨ban_aparagi-m.wav/content?download=1","https://zenodo.org/api/records/16753649/files/005_unu_otooga_dekaseginkai_ik-i.wav/content?download=1","https://zenodo.org/api/records/16753649/files/006_tuusanu_jaejamaatarinkai_en.wav/content?download=1","https://zenodo.org/api/records/16753649/files/007_nannicimai_fÉ¨nin_nuur-i-i_ut.wav/content?download=1","https://zenodo.org/api/records/16753649/files/008_jaankai_fÉ¨É¨-gumatatinu_tukj.wav/content?download=1","https://zenodo.org/api/records/16753649/files/009_tamamigaa_ttigaa_otoojubaa.wav/content?download=1","https://zenodo.org/api/records/16753649/files/010_nkjaandu_tuufÉ¨nudu_gocisoo.wav/content?download=1","https://zenodo.org/api/records/16753649/files/011_tuuffa_cÉ¨ff-i-i_utui-i_otoo_n.wav/content?download=1","https://zenodo.org/api/records/16753649/files/012_tuufÉ¨_tuufÉ¨nu_ukusu_ukusumizÉ¨.wav/content?download=1","https://zenodo.org/api/records/16753649/files/013_taguu_muc-i-ii.wav/content?download=1","https://zenodo.org/api/records/16753649/files/014_ukusu-mizÉ¨_fÉ¨mtii_ifÉ¨-tarca.wav/content?download=1","https://zenodo.org/api/records/16753649/files/015_unu_tuki-naginna.wav/content?download=1","https://zenodo.org/api/records/16753649/files/016_anu_bizinnu_aparagi-pzÌŒtunkai.wav/content?download=1","https://zenodo.org/api/records/16753649/files/017_ironna_bjookikara_mamonokara.wav/content?download=1","https://zenodo.org/api/records/16753649/files/018_majokenu_tamendu_sÉ¨miu_hit.wav/content?download=1","https://zenodo.org/api/records/16753649/files/019_nabinu_ffusÉ¨É¨.wav/content?download=1","https://zenodo.org/api/records/16753649/files/020_nabinu_sÉ¨mi_ffusÉ¨É¨ju.wav/content?download=1","https://zenodo.org/api/records/16753649/files/021_hitainkai_cÉ¨ki-ikara_icÉ¨gu_m.wav/content?download=1","https://zenodo.org/api/records/16753649/files/022_aparagi-ka-i-ba_tur-ai-zjaant.wav/content?download=1","https://zenodo.org/api/records/16753649/files/023_dakedo_unu_pzÌŒzÌŒnna_mmja_bassi.wav/content?download=1","https://zenodo.org/api/records/16753649/files/024_mmja_taguu_mucii_mmja_imnu_p.wav/content?download=1","https://zenodo.org/api/records/16753649/files/025_iravnu_pamankai.wav/content?download=1","https://zenodo.org/api/records/16753649/files/026_asi_mmja_kjuuja_mmja_paikazi-.wav/content?download=1","https://zenodo.org/api/records/16753649/files/027_otooga_fÉ¨ninudu_fÉ¨É¨ti.wav/content?download=1","https://zenodo.org/api/records/16753649/files/028_mmja_uriu_pukarassa-as-i-i_ur.wav/content?download=1","https://zenodo.org/api/records/16753649/files/029_ukusu-mizÉ¨_fÉ¨m-i-ur_aidandu.wav/content?download=1","https://zenodo.org/api/records/16753649/files/030_nzagagarakara_mmja_mamununu.wav/content?download=1","https://zenodo.org/api/records/16753649/files/031_tamamigau_mmja_sara-i-i_par-t.wav/content?download=1","https://zenodo.org/api/records/16753649/files/032_sara-i-i_ik-i-i_umanu_accanu.wav/content?download=1","https://zenodo.org/api/records/16753649/files/033_umankai-jas-i-i_mmja_kaffi-i.wav/content?download=1","https://zenodo.org/api/records/16753649/files/034_saar-i-i_par-tarca.wav/content?download=1","https://zenodo.org/api/records/16753649/files/035_asi_icÉ¨-gamimai_jaankai_kuu.wav/content?download=1","https://zenodo.org/api/records/16753649/files/036_tamamiga_tamamigati_uma-nagi.wav/content?download=1","https://zenodo.org/api/records/16753649/files/037_tamamiga_tamamigati_hamagami.wav/content?download=1","https://zenodo.org/api/records/16753649/files/038_unu_paman_tagunu_mmja_nagir-.wav/content?download=1","https://zenodo.org/api/records/16753649/files/039_taruu_cumma_mii-nsiba.wav/content?download=1","https://zenodo.org/api/records/16753649/files/040_agai_tamamigajooiti_uma-nagi.wav/content?download=1","https://zenodo.org/api/records/16753649/files/041_nacÉ¨nna_nak-i-i_nannicimai.wav/content?download=1","https://zenodo.org/api/records/16753649/files/042_nivv-i-ur-tigaa.wav/content?download=1","https://zenodo.org/api/records/16753649/files/043_mmja_jumenu_nakan.wav/content?download=1","https://zenodo.org/api/records/16753649/files/044_hai_anna_icÉ¨gamimai_ai_kanas.wav/content?download=1","https://zenodo.org/api/records/16753649/files/045_nak-i-ur-na.wav/content?download=1","https://zenodo.org/api/records/16753649/files/046_naraa_umanu_nuusiutakinu_nu.wav/content?download=1","https://zenodo.org/api/records/16753649/files/047_nu_kamisaman_nar-i-i_uman_u.wav/content?download=1","https://zenodo.org/api/records/16753649/files/048_mmja_naraga_kutuba_mmja_sjuw.wav/content?download=1","https://zenodo.org/api/records/16753649/files/049_agai_umanu_kamisamandu_nar.wav/content?download=1","https://zenodo.org/api/records/16753649/files/050_uman_ik-i-i_mmja_kamma_niga-.wav/content?download=1","https://zenodo.org/api/records/16753649/files/051_kamisamanu_mminkai_zjautuun.wav/content?download=1","https://zenodo.org/api/records/16753649/files/052_mmnasii_kamma_niga-i.wav/content?download=1","https://zenodo.org/api/records/16753649/files/053_unkara_umanu_nuusiutakiuba.wav/content?download=1","https://zenodo.org/api/records/16753649/files/054_kamnigaiu_icÉ¨gu_as-i-urri.wav/content?download=1","https://zenodo.org/api/records/16753649/files/20250301_irabu_tomiyama_02.wav/content?download=1"],
                        fullAudioUrl: "https://zenodo.org/api/records/16753649/files/text_tamamiga.wav/content?download=1"
                    };
                </script><script>
        // PDFjs workerã®è¨­å®š
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let examples = [];
        let audioUrls = [];
        let fullAudioUrl = '';
        let currentlyPlaying = null;
        let useCorsProxy = true; // CORSãƒ—ãƒ­ã‚­ã‚·ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã©ã†ã‹
        
        // Zenodoãƒ¬ã‚³ãƒ¼ãƒ‰URLã‹ã‚‰éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«URLã‚’å–å¾—
        async function fetchZenodoFiles(recordUrl) {
            // Zenodoã®ãƒ¬ã‚³ãƒ¼ãƒ‰URLã‹ã‚‰ãƒ¬ã‚³ãƒ¼ãƒ‰IDã‚’æŠ½å‡º
            const match = recordUrl.match(/zenodo\.org\/records\/(\d+)/);
            if (!match) {
                throw new Error('ç„¡åŠ¹ãªZenodo URLã§ã™ã€‚ä¾‹: https://zenodo.org/records/12345678');
            }
            
            const recordId = match[1];
            const apiUrl = `https://zenodo.org/api/records/${recordId}`;
            
            // CORSãƒ—ãƒ­ã‚­ã‚·ã‚’è©¦è¡Œï¼ˆè¤‡æ•°ã®ãƒ—ãƒ­ã‚­ã‚·ã‚’é †ç•ªã«è©¦ã™ï¼‰
            const proxyUrls = [
                apiUrl, // ã¾ãšç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã‚’è©¦ã¿ã‚‹
                `https://corsproxy.io/?${encodeURIComponent(apiUrl)}`,
                `https://api.allorigins.win/get?url=${encodeURIComponent(apiUrl)}`,
                `https://thingproxy.freeboard.io/fetch/${apiUrl}`,
                `https://cors.bridged.cc/${apiUrl}`
            ];
            
            let data = null;
            let lastError = null;
            
            for (const url of proxyUrls) {
                try {
                    console.log('Trying:', url);
                    const response = await fetch(url);
                    if (response.ok) {
                        let jsonData = await response.json();
                        // alloriginsã¯contentsãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹
                        if (jsonData.contents) {
                            jsonData = JSON.parse(jsonData.contents);
                        }
                        data = jsonData;
                        console.log('Success with:', url);
                        break;
                    }
                } catch (e) {
                    lastError = e;
                    console.log(`Proxy failed: ${url}`, e.message);
                }
            }
            
            if (!data) {
                throw new Error('Zenodo APIã¸ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸã€‚CORSãƒ—ãƒ­ã‚­ã‚·ãŒã™ã¹ã¦åˆ©ç”¨ä¸å¯ã§ã™ã€‚');
            }
            
            if (!data.files || data.files.length === 0) {
                throw new Error('ã“ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã«ã¯ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“');
            }
            
            // éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            const audioExtensions = ['.wav', '.mp3', '.ogg', '.flac', '.m4a'];
            const audioFiles = data.files.filter(f => {
                const ext = f.key.toLowerCase().substring(f.key.lastIndexOf('.'));
                return audioExtensions.includes(ext);
            });
            
            if (audioFiles.length === 0) {
                throw new Error('éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼ˆ.wav, .mp3ãªã©ï¼‰');
            }
            
            // å€‹åˆ¥éŸ³å£°ï¼ˆ001_, 002_ãªã©ï¼‰ã¨å…¨ä½“éŸ³å£°ï¼ˆtext_ãªã©ï¼‰ã‚’åˆ†é›¢
            const individualFiles = [];
            let fullAudioFile = null;
            
            for (const f of audioFiles) {
                const filename = f.key;
                // æ•°å­—3æ¡_ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯å€‹åˆ¥éŸ³å£°
                if (/^\d{3}_/.test(filename)) {
                    individualFiles.push(f);
                } 
                // text_ã§å§‹ã¾ã‚‹ã€ã¾ãŸã¯ "full" ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã¯å…¨ä½“éŸ³å£°
                else if (/^text_/i.test(filename) || /full/i.test(filename)) {
                    fullAudioFile = f;
                }
                // ãã‚Œä»¥å¤–ã§ç•ªå·ãŒå«ã¾ã‚Œãªã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å…¨ä½“éŸ³å£°å€™è£œ
                else if (!/\d{3}/.test(filename)) {
                    fullAudioFile = f;
                }
                // ãã‚Œä»¥å¤–ã¯å€‹åˆ¥éŸ³å£°ã¨ã—ã¦æ‰±ã†
                else {
                    individualFiles.push(f);
                }
            }
            
            // ãƒ•ã‚¡ã‚¤ãƒ«åã§ã‚½ãƒ¼ãƒˆï¼ˆ001_, 002_ãªã©ã®ç•ªå·é †ï¼‰
            individualFiles.sort((a, b) => a.key.localeCompare(b.key, undefined, { numeric: true }));
            
            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLã‚’ç”Ÿæˆ
            const individualUrls = individualFiles.map(f => f.links.self + '?download=1');
            const fullUrl = fullAudioFile ? fullAudioFile.links.self + '?download=1' : null;
            
            return {
                individualUrls,
                fullAudioUrl: fullUrl,
                fullAudioFilename: fullAudioFile ? fullAudioFile.key : null
            };
        }
        
        // ã‚°ãƒ­ã‚¹ã®å’Œè¨³è¾æ›¸ï¼ˆSearchGlossãƒ™ãƒ¼ã‚¹ - æ‹¡å¼µç‰ˆï¼‰
        const glossDictionary = {
            // æ ¼æ¨™è­˜
            'nom': 'ä¸»æ ¼',
            'gen': 'å±æ ¼',
            'acc': 'å¯¾æ ¼',
            'dat': 'ä¸æ ¼',
            'abl': 'å¥ªæ ¼',
            'ins': 'å…·æ ¼',
            'com': 'å…±æ ¼',
            'all': 'å‘æ ¼',
            'loc': 'æ‰€æ ¼',
            'voc': 'å‘¼æ ¼',
            
            // æ ¼ã®å¤‰ç¨®
            'nom1': 'ä¸»æ ¼1',
            'nom2': 'ä¸»æ ¼2',
            'gen1': 'å±æ ¼1',
            'gen2': 'å±æ ¼2',
            'acc1': 'å¯¾æ ¼1',
            'acc2': 'å¯¾æ ¼2',
            
            // æ™‚åˆ¶ãƒ»ã‚¢ã‚¹ãƒšã‚¯ãƒˆ
            'pst': 'éå»',
            'npst': 'ééå»',
            'prs': 'ç¾åœ¨',
            'fut': 'æœªæ¥',
            'dfut': 'é ã„æœªæ¥',
            'prog': 'é€²è¡Œ',
            'perf': 'å®Œäº†',
            'ipfv': 'æœªå®Œäº†',
            'pfv': 'å®Œäº†',
            
            // ãƒ¢ãƒ€ãƒªãƒ†ã‚£
            'pot': 'å¯èƒ½',
            'dub': 'æ¨é‡',
            'pros': 'æ¨æ¸¬',
            'seem': 'æ¨æ¸¬',
            'chs': 'æ¨å®š',
            'hs': 'ä¼è',
            'asr': 'æ–­å®š',
            'cnf': 'ç¢ºèª',
            'q': 'ç–‘å•',
            
            // æ³•
            'imp': 'å‘½ä»¤',
            'proh': 'ç¦æ­¢',
            'opt': 'å¸Œæ±‚',
            'int': 'æ„å¿—',
            'hort': 'å‹§èª˜',
            'cond': 'æ¡ä»¶',
            
            // æ…‹
            'pass': 'å—èº«',
            'caus': 'ä½¿å½¹',
            'cvlz': 'ä½¿å½¹åŒ–',
            'refl': 'å†å¸°',
            'rfl': 'å†å¸°',
            'recip': 'ç›¸äº’',
            
            // è«‡è©±æ©Ÿèƒ½
            'top': 'ä¸»é¡Œ',
            'foc': 'ç„¦ç‚¹',
            'otop': 'å¯¾æ¯”ä¸»é¡Œ',
            'thm': 'ãƒ†ãƒ¼ãƒ',
            'quot': 'å¼•ç”¨',
            'dsc': 'è«‡è©±æ¨™è­˜',
            'fil': 'ãƒ•ã‚£ãƒ©ãƒ¼',
            
            // æ•°ãƒ»äººç§°
            'sg': 'å˜æ•°',
            'pl': 'è¤‡æ•°',
            'du': 'åŒæ•°',
            '1': '1äººç§°',
            '2': '2äººç§°',
            '3': '3äººç§°',
            'incl': 'åŒ…æ‹¬',
            'excl': 'é™¤å¤–',
            
            // æ•¬èª
            'hon': 'æ•¬èª',
            'hum': 'è¬™è­²',
            'pol': 'ä¸å¯§',
            'adr': 'æ•¬èª',
            
            // æ¥ç¶š
            'seq': 'ç¶™èµ·',
            'sim': 'åŒæ™‚',
            'ant': 'å…ˆè¡Œ',
            'csl': 'ç†ç”±',
            'rsl': 'çµæœ',
            'cnc': 'é€†æ¥',
            'add': 'æ·»åŠ ',
            
            // æ´¾ç”Ÿ
            'nlz': 'åè©åŒ–',
            'cnlz': 'åè©åŒ–',
            'vlz': 'å‹•è©åŒ–',
            'adj': 'å½¢å®¹è©',
            'adv': 'å‰¯è©',
            
            // ãã®ä»–
            'neg': 'å¦å®š',
            'cop': 'ã‚³ãƒ”ãƒ¥ãƒ©',
            'lv': 'è»½å‹•è©',
            'aux': 'åŠ©å‹•è©',
            'clf': 'é¡åˆ¥è©',
            'dim': 'æŒ‡å°è¾',
            'aug': 'å¢—å¤§è¾',
            'ben': 'å—ç›Š',
            'mal': 'è¢«å®³',
            'inf': 'ä¸­æ­¢',
            'cvb': 'å‰¯å‹•è©',
            'ptcp': 'åˆ†è©',
            'ger': 'å‹•åè©',
            
            // æŒ‡ç¤º
            'prox': 'è¿‘ç§°',
            'med': 'ä¸­ç§°',
            'dist': 'é ç§°',
            'indf': 'ä¸å®š',
            
            // é™å®š
            'aprx': 'è¿‘ä¼¼',
            'lmt': 'é™ç•Œ',
            'only': 'é™å®š',
            'also': 'ã‚‚',
            'even': 'ã•ãˆ',
            
            // ãã®ä»–ã®æ©Ÿèƒ½
            'crcm': 'çŠ¶æ³',
            'onm': 'ã‚ªãƒãƒãƒˆãƒš',
            'intj': 'é–“æŠ•è©',
            'conn': 'æ¥ç¶šè©',
            'prt': 'åŠ©è©',
            'post': 'å¾Œç½®è©',
            'prep': 'å‰ç½®è©',
            
            // æ–¹è¨€ç‰¹æœ‰ã®ã‚°ãƒ­ã‚¹ï¼ˆå¿…è¦ã«å¿œã˜ã¦è¿½åŠ ï¼‰
            'evid': 'è¨¼æ‹ æ€§',
            'mir': 'æ„å¤–æ€§',
            'exp': 'çµŒé¨“',
            'hab': 'ç¿’æ…£',
            'iter': 'åå¾©',
            'sem': 'ç¬é–“',
            'tel': 'å®Œæˆ',
            'atel': 'éå®Œæˆ',
            'inch': 'èµ·å‹•',
            'term': 'çµ‚çµ',
            'cont': 'ç¶™ç¶š',
            'punc': 'ç¬æ™‚',
            'dur': 'æŒç¶š',
            'freq': 'é »åº¦',
            'distr': 'é…åˆ†',
            'coll': 'é›†åˆ',
            'assoc': 'éšä¼´',
            'priv': 'æ¬ å¦‚',
            'poss': 'æ‰€æœ‰',
            'part': 'éƒ¨åˆ†',
            'temp': 'æ™‚',
            'mann': 'æ§˜æ…‹',
            'purp': 'ç›®çš„',
            'inst': 'é“å…·',
            'conc': 'è­²æ­©',
            'comp': 'æ¯”è¼ƒ',
            'super': 'æœ€ä¸Šç´š',
            'equ': 'åŒç­‰',
            'sim': 'é¡ä¼¼',
            'diff': 'ç›¸é•'
        };
        
        
        // DOMã®èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            
            // åŸ‹ã‚è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯è‡ªå‹•çš„ã«å‡¦ç†
            if (window.embeddedData) {
                processFiles();
            }
        });
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function setupEventListeners() {
            // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠæ™‚ã®å‡¦ç†
            const dataFile = document.getElementById('dataFile');
            if (dataFile) dataFile.addEventListener('change', checkFiles);
            
            // å‡¦ç†ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯
            const processButton = document.getElementById('processButton');
            if (processButton) processButton.addEventListener('click', processFiles);
            
            // å…¨ä½“éŸ³å£°å†ç”Ÿãƒœã‚¿ãƒ³
            const playAllBtn = document.getElementById('playAllBtn');
            if (playAllBtn) playAllBtn.addEventListener('click', playFullAudio);
            
            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯
            const downloadBtn = document.getElementById('downloadBtn');
            if (downloadBtn) downloadBtn.addEventListener('click', downloadHTML);
            
            // Zenodoå–å¾—ãƒœã‚¿ãƒ³
            const zenodoFetchBtn = document.getElementById('zenodoFetchBtn');
            if (zenodoFetchBtn) {
                zenodoFetchBtn.addEventListener('click', async function() {
                    const zenodoInput = document.getElementById('zenodoUrl');
                    const zenodoStatus = document.getElementById('zenodoStatus');
                    const fullAudioUrlInput = document.getElementById('fullAudioUrl');
                    const recordUrl = zenodoInput.value.trim();
                    
                    if (!recordUrl) {
                        zenodoStatus.textContent = 'âŒ Zenodoãƒ¬ã‚³ãƒ¼ãƒ‰URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„';
                        zenodoStatus.className = 'zenodo-status error';
                        return;
                    }
                    
                    // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
                    zenodoFetchBtn.disabled = true;
                    zenodoFetchBtn.textContent = 'â³ å–å¾—ä¸­...';
                    zenodoStatus.textContent = 'Zenodo APIã«æ¥ç¶šä¸­...';
                    zenodoStatus.className = 'zenodo-status';
                    
                    try {
                        const result = await fetchZenodoFiles(recordUrl);
                        
                        // å€‹åˆ¥éŸ³å£°URLsã«è¨­å®š
                        audioUrls = result.individualUrls;
                        
                        // å…¨ä½“éŸ³å£°URLã‚’è¨­å®š
                        if (result.fullAudioUrl && fullAudioUrlInput) {
                            fullAudioUrl = result.fullAudioUrl;
                            fullAudioUrlInput.value = result.fullAudioUrl;
                        }
                        
                        // æ‰‹å‹•å…¥åŠ›ã‚¨ãƒªã‚¢ã«ã‚‚URLãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
                        const manualUrlList = document.getElementById('manualUrlList');
                        if (manualUrlList) {
                            manualUrlList.value = result.individualUrls.join('\n');
                        }
                        const manualUrlCount = document.getElementById('manualUrlCount');
                        if (manualUrlCount) {
                            manualUrlCount.textContent = `âœ… ${result.individualUrls.length}ä»¶ã®URL`;
                            manualUrlCount.className = 'manual-url-count has-urls';
                        }
                        
                        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆ
                        let statusMsg = `âœ… ${result.individualUrls.length}ä»¶ã®å€‹åˆ¥éŸ³å£°`;
                        if (result.fullAudioUrl) {
                            statusMsg += ` + å…¨ä½“éŸ³å£°ï¼ˆ${result.fullAudioFilename}ï¼‰`;
                        }
                        statusMsg += 'ã‚’å–å¾—ã—ã¾ã—ãŸ';
                        
                        zenodoStatus.textContent = statusMsg;
                        zenodoStatus.className = 'zenodo-status success';
                        
                        // å‡¦ç†ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
                        checkFiles();
                        
                    } catch (err) {
                        zenodoStatus.textContent = 'âŒ ' + err.message;
                        zenodoStatus.className = 'zenodo-status error';
                    } finally {
                        zenodoFetchBtn.disabled = false;
                        zenodoFetchBtn.textContent = 'ğŸ“¥ å–å¾—';
                    }
                });
            }
            
            // æ‰‹å‹•URLå…¥åŠ›ã‚¨ãƒªã‚¢
            const manualUrlList = document.getElementById('manualUrlList');
            if (manualUrlList) {
                manualUrlList.addEventListener('input', function(e) {
                    const text = e.target.value;
                    const urls = text.trim().split('\n')
                        .map(u => u.trim())
                        .filter(u => u && u.startsWith('http'));
                    
                    audioUrls = urls;
                    
                    const countEl = document.getElementById('manualUrlCount');
                    if (countEl) {
                        if (urls.length > 0) {
                            countEl.textContent = `âœ… ${urls.length}ä»¶ã®URL`;
                            countEl.className = 'manual-url-count has-urls';
                        } else {
                            countEl.textContent = '';
                            countEl.className = 'manual-url-count';
                        }
                    }
                    
                    checkFiles();
                });
            }
            
            // ã‚°ãƒ­ã‚¹ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            document.addEventListener('click', async function(e) {
                if (e.target.classList.contains('gloss-clickable')) {
                    e.stopPropagation();
                    const gloss = e.target.dataset.gloss;
                    await showGlossTooltip(gloss, e.target);
                } else if (!e.target.closest('.gloss-tooltip')) {
                    hideGlossTooltip();
                }
            });
            
            // éŸ³å£°çµ‚äº†æ™‚ã®å‡¦ç†
            const audio = document.getElementById('audio');
            if (audio) {
                audio.addEventListener('ended', function() {
                    updatePlayingState(null);
                });
                
                audio.addEventListener('timeupdate', updateProgress);
            }
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        function checkFiles() {
            const dataFile = document.getElementById('dataFile').files[0];
            const processButton = document.getElementById('processButton');
            
            // ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã€ã‹ã¤Zenodoã‹ã‚‰å–å¾—æ¸ˆã¿
            processButton.disabled = !(dataFile && audioUrls.length > 0);
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ï¼ˆåŸ‹ã‚è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ç‰ˆï¼‰
        async function processFiles() {
            // åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
            if (window.embeddedData) {
                examples = window.embeddedData.examples;
                audioUrls = window.embeddedData.audioUrls;
                fullAudioUrl = window.embeddedData.fullAudioUrl;
                
                console.log('åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™');
                console.log(`ä¾‹æ–‡æ•°: ${examples.length}`);
                console.log(`éŸ³å£°URLæ•°: ${audioUrls.length}`);
                
                // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
                displayContent();
                
                // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
                const uploadSection = document.getElementById('uploadSection');
                if (uploadSection) {
                    uploadSection.style.display = 'none';
                }
                document.getElementById('contentSection').style.display = 'block';
                
                return;
            }
            
            // å…ƒã®processFilesé–¢æ•°ã®ã‚³ãƒ¼ãƒ‰
            
            const dataFile = document.getElementById('dataFile').files[0];
            const titleInput = document.getElementById('titleInput').value.trim();
            const subtitleInput = document.getElementById('subtitleInput').value.trim();
            
            try {
                showStatus('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ä¸­...', 'info');
                
                // ã‚¿ã‚¤ãƒˆãƒ«ã¨ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¨­å®š
                if (titleInput) {
                    document.getElementById('pageTitle').textContent = titleInput;
                }
                if (subtitleInput) {
                    document.getElementById('pageSubtitle').textContent = subtitleInput;
                }
                
                // å…¨ä½“éŸ³å£°URLã‚’ç¢ºèªï¼ˆæ‰‹å‹•ã§å¤‰æ›´ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ï¼‰
                const fullAudioUrlInput = document.getElementById('fullAudioUrl');
                const fullAudioInputValue = fullAudioUrlInput ? fullAudioUrlInput.value.trim() : '';
                if (fullAudioInputValue) {
                    fullAudioUrl = fullAudioInputValue;
                }
                
                console.log(`éŸ³å£°URLã‚’${audioUrls.length}å€‹èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
                if (fullAudioUrl) {
                    console.log('å…¨ä½“éŸ³å£°URL:', fullAudioUrl);
                }
                
                // ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ï¼ˆãƒ†ã‚­ã‚¹ãƒˆã¾ãŸã¯PDFï¼‰
                if (dataFile.name.endsWith('.txt')) {
                    await processTextFile(dataFile);
                } else if (dataFile.name.endsWith('.pdf')) {
                    await processPDF(dataFile);
                }
                
                // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
                displayContent();
                
                showStatus('å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸï¼', 'success');
                
                // 2ç§’å¾Œã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
                setTimeout(() => {
                    document.getElementById('uploadSection').style.display = 'none';
                    document.getElementById('contentSection').style.display = 'block';
                }, 2000);
                
            } catch (error) {
                showStatus('ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
                console.error(error);
            }
        }
        
        // ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†
        async function processTextFile(file) {
            const text = await file.text();
            const lines = text.split('\n');
            
            examples = [];
            let lineIndex = 0;
            
            while (lineIndex < lines.length) {
                const line = lines[lineIndex].trim();
                
                // ä¾‹æ–‡ç•ªå·ã®æ¤œå‡º
                const numberMatch = line.match(/^\((\d+)\)$/);
                if (numberMatch) {
                    const id = parseInt(numberMatch[1]);
                    const currentExample = {
                        id: id,
                        original: '',
                        gloss: '',
                        japanese: ''
                    };
                    
                    // æ¬¡ã®è¡Œã‹ã‚‰å†…å®¹ã‚’åé›†
                    const contentLines = [];
                    lineIndex++;
                    
                    // æ¬¡ã®ä¾‹æ–‡ç•ªå·ãŒæ¥ã‚‹ã¾ã§ã€ã¾ãŸã¯ç©ºè¡ŒãŒé€£ç¶šã™ã‚‹ã¾ã§è¡Œã‚’åé›†
                    while (lineIndex < lines.length) {
                        const nextLine = lines[lineIndex].trim();
                        
                        // æ¬¡ã®ä¾‹æ–‡ç•ªå·ã«åˆ°é”ã—ãŸã‚‰çµ‚äº†
                        if (nextLine.match(/^\((\d+)\)$/)) {
                            break;
                        }
                        
                        // ç©ºè¡Œã¯ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ãŒã€åé›†ã¯ç¶šã‘ã‚‹
                        if (nextLine) {
                            contentLines.push(nextLine);
                        }
                        
                        lineIndex++;
                    }
                    
                    // åé›†ã—ãŸè¡Œæ•°ã«åŸºã¥ã„ã¦å½¢å¼ã‚’åˆ¤å®š
                    if (contentLines.length === 2) {
                        // 2è¡Œå½¢å¼: ä¾‹æ–‡ã€æ—¥æœ¬èªè¨³
                        currentExample.original = contentLines[0];
                        currentExample.japanese = contentLines[1];
                        currentExample.gloss = ''; // ã‚°ãƒ­ã‚¹ãªã—
                    } else if (contentLines.length === 3) {
                        // 3è¡Œå½¢å¼: åŸæ–‡ã€ã‚°ãƒ­ã‚¹ã€æ—¥æœ¬èªè¨³
                        currentExample.original = contentLines[0];
                        currentExample.gloss = contentLines[1];
                        currentExample.japanese = contentLines[2];
                    } else if (contentLines.length >= 4) {
                        // 4è¡Œå½¢å¼: ã‚¹ãƒšãƒ¼ã‚¹ã‚ã‚Šä¾‹æ–‡ã€å½¢æ…‹ç´ å¢ƒç•Œå…¥ã‚Šä¾‹æ–‡ã€ã‚°ãƒ­ã‚¹ã€æ—¥æœ¬èªè¨³
                        currentExample.originalSpaced = contentLines[0]; // ã‚¹ãƒšãƒ¼ã‚¹ã‚ã‚Šä¾‹æ–‡
                        currentExample.original = contentLines[1]; // å½¢æ…‹ç´ å¢ƒç•Œå…¥ã‚Šä¾‹æ–‡
                        currentExample.gloss = contentLines[2];
                        currentExample.japanese = contentLines[3];
                        
                        // æ—¥æœ¬èªè¨³ãŒè¤‡æ•°è¡Œã«ã‚ãŸã‚‹å ´åˆã¯çµåˆ
                        for (let i = 4; i < contentLines.length; i++) {
                            if (contentLines[i].match(/[\u3040-\u309f\u30a0-\u30ff\u4e00-\u9faf]/)) {
                                currentExample.japanese += contentLines[i];
                            }
                        }
                    }
                    
                    // ä¾‹æ–‡ã‚’è¿½åŠ 
                    if (currentExample.original) {
                        examples.push(currentExample);
                    }
                } else {
                    lineIndex++;
                }
            }
            
            console.log(`ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰${examples.length}å€‹ã®ä¾‹æ–‡ã‚’æŠ½å‡ºã—ã¾ã—ãŸ`);
            
            // ãƒ‡ãƒãƒƒã‚°ç”¨ï¼šæœ€åˆã®3ã¤ã®ä¾‹æ–‡ã‚’è¡¨ç¤º
            examples.slice(0, 3).forEach(ex => {
                console.log(`ä¾‹æ–‡${ex.id}:`);
                console.log(`  åŸæ–‡: ${ex.original}`);
                console.log(`  ã‚°ãƒ­ã‚¹: ${ex.gloss}`);
                console.log(`  æ—¥æœ¬èª: ${ex.japanese}`);
            });
        }
        
        // PDFã‚’å‡¦ç†
        async function processPDF(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
            
            examples = [];
            let allTextItems = [];
            
            // å…¨ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã‚’åé›†
            for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {
                const page = await pdf.getPage(pageNum);
                const textContent = await page.getTextContent();
                
                textContent.items.forEach(item => {
                    if (item.str.trim()) {
                        allTextItems.push({
                            text: item.str,
                            x: item.transform[4],
                            y: item.transform[5],
                            page: pageNum
                        });
                    }
                });
            }
            
            // Yåº§æ¨™ã§ã‚½ãƒ¼ãƒˆï¼ˆä¸Šã‹ã‚‰ä¸‹ã¸ï¼‰
            allTextItems.sort((a, b) => {
                if (a.page !== b.page) return a.page - b.page;
                return b.y - a.y;
            });
            
            // åŒã˜è¡Œã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
            let lines = [];
            let currentLine = [];
            let lastY = null;
            
            allTextItems.forEach(item => {
                if (lastY === null || Math.abs(item.y - lastY) < 5) {
                    currentLine.push(item);
                } else {
                    if (currentLine.length > 0) {
                        // Xåº§æ¨™ã§ã‚½ãƒ¼ãƒˆï¼ˆå·¦ã‹ã‚‰å³ã¸ï¼‰
                        currentLine.sort((a, b) => a.x - b.x);
                        const lineText = currentLine.map(i => i.text).join(' ');
                        lines.push(lineText);
                    }
                    currentLine = [item];
                }
                lastY = item.y;
            });
            
            // æœ€å¾Œã®è¡Œã‚’è¿½åŠ 
            if (currentLine.length > 0) {
                currentLine.sort((a, b) => a.x - b.x);
                const lineText = currentLine.map(i => i.text).join(' ');
                lines.push(lineText);
            }
            
            // ä¾‹æ–‡ã‚’è§£æ
            let currentExample = null;
            let expectingGloss = false;
            let expectingJapanese = false;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                // ä¾‹æ–‡ç•ªå·ã®æ¤œå‡º
                const numberMatch = line.match(/^[\(ï¼ˆ](\d+)[\)ï¼‰]\s*(.+)$/);
                if (numberMatch) {
                    // å‰ã®ä¾‹æ–‡ã‚’ä¿å­˜
                    if (currentExample) {
                        examples.push(currentExample);
                    }
                    
                    currentExample = {
                        id: parseInt(numberMatch[1]),
                        original: numberMatch[2].trim(),
                        gloss: '',
                        japanese: ''
                    };
                    expectingGloss = true;
                    expectingJapanese = false;
                } else if (currentExample && expectingGloss) {
                    // ã‚°ãƒ­ã‚¹è¡Œï¼ˆå°æ–‡å­—ã€ãƒ”ãƒªã‚ªãƒ‰ã€å¤§æ–‡å­—ã‚’å«ã‚€ï¼‰
                    if (line.match(/^[a-zA-Z0-9\.\-\s]+$/)) {
                        currentExample.gloss = line;
                        expectingGloss = false;
                        expectingJapanese = true;
                    }
                } else if (currentExample && expectingJapanese) {
                    // æ—¥æœ¬èªè¨³
                    if (line.match(/[\u3040-\u309f\u30a0-\u30ff\u4e00-\u9faf]/)) {
                        currentExample.japanese = line;
                        expectingJapanese = false;
                    }
                }
            }
            
            // æœ€å¾Œã®ä¾‹æ–‡ã‚’ä¿å­˜
            if (currentExample) {
                examples.push(currentExample);
            }
            
            console.log(`PDFã‹ã‚‰${examples.length}å€‹ã®ä¾‹æ–‡ã‚’æŠ½å‡ºã—ã¾ã—ãŸ`);
            
            // ãƒ‡ãƒãƒƒã‚°ç”¨ï¼šæœ€åˆã®3ã¤ã®ä¾‹æ–‡ã‚’è¡¨ç¤º
            examples.slice(0, 3).forEach(ex => {
                console.log(`ä¾‹æ–‡${ex.id}:`);
                console.log(`  åŸæ–‡: ${ex.original}`);
                console.log(`  ã‚°ãƒ­ã‚¹: ${ex.gloss}`);
                console.log(`  æ—¥æœ¬èª: ${ex.japanese}`);
            });
        }
        
        // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
        function displayContent() {
            const exampleList = document.getElementById('exampleList');
            const exampleCount = document.getElementById('exampleCount');
            const playAllBtn = document.getElementById('playAllBtn');
            
            // ä¾‹æ–‡æ•°ã‚’è¡¨ç¤º
            exampleCount.textContent = examples.length;
            
            // ä¾‹æ–‡ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
            exampleList.innerHTML = '';
            
            // å„ä¾‹æ–‡ã‚’è¡¨ç¤º
            examples.forEach((example, index) => {
                const exampleItem = createExampleElement(example, index);
                exampleList.appendChild(exampleItem);
            });
            
            // å…¨ä½“éŸ³å£°ãƒœã‚¿ãƒ³ã®è¡¨ç¤º/éè¡¨ç¤º
            if (!fullAudioUrl) {
                playAllBtn.style.display = 'none';
            } else {
                playAllBtn.style.display = 'flex';
            }
        }
        
        // ä¾‹æ–‡è¦ç´ ã‚’ä½œæˆ
        function createExampleElement(example, index) {
            const div = document.createElement('div');
            div.className = 'example-item';
            div.dataset.id = example.id;
            
            // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒªãƒ‹ã‚¢å½¢å¼ã§è¡¨ç¤º
            let interlinearHTML;
            if (example.originalSpaced) {
                // 4è¡Œå½¢å¼ã®å ´åˆ
                interlinearHTML = createInterlinearHTML4Line(example.originalSpaced, example.original, example.gloss);
            } else {
                // 2è¡Œã¾ãŸã¯3è¡Œå½¢å¼ã®å ´åˆ
                interlinearHTML = createInterlinearHTML(example.original, example.gloss);
            }
            
            div.innerHTML = `
                <div class="example-number">(${example.id})</div>
                <div class="example-text">
                    <div class="interlinear-container">
                        ${interlinearHTML}
                    </div>
                    <div class="translation-text">${example.japanese}</div>
                </div>
                <div class="play-icon">â–¶</div>
            `;
            
            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
            div.addEventListener('click', function(e) {
                if (!e.target.classList.contains('gloss-clickable')) {
                    playExample(example.id);
                }
            });
            
            return div;
        }
        
        // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒªãƒ‹ã‚¢å½¢å¼ã®HTMLã‚’ç”Ÿæˆ
        function createInterlinearHTML(originalText, glossText) {
            const originalWords = originalText.split(/\s+/);
            const glossWords = glossText.split(/\s+/);
            
            let html = '<div class="interlinear-row">';
            
            for (let i = 0; i < Math.max(originalWords.length, glossWords.length); i++) {
                const originalWord = originalWords[i] || '';
                const glossWord = glossWords[i] || '';
                
                // ã‚°ãƒ­ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ã™ã‚‹
                const clickableGloss = makeGlossClickable(glossWord);
                
                html += `
                    <div class="word-group">
                        <div class="original-word">${originalWord}</div>
                        <div class="gloss-word">${clickableGloss}</div>
                    </div>
                `;
            }
            
            html += '</div>';
            return html;
        }
        
        // 4è¡Œå½¢å¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒªãƒ‹ã‚¢HTMLã‚’ç”Ÿæˆ
        function createInterlinearHTML4Line(spacedText, boundaryText, glossText) {
            const spacedWords = spacedText.split(/\s+/);
            const boundaryWords = boundaryText.split(/\s+/);
            const glossWords = glossText.split(/\s+/);
            
            let html = '<div class="interlinear-row">';
            
            for (let i = 0; i < Math.max(spacedWords.length, boundaryWords.length, glossWords.length); i++) {
                const spacedWord = spacedWords[i] || '';
                const boundaryWord = boundaryWords[i] || '';
                const glossWord = glossWords[i] || '';
                
                // ã‚°ãƒ­ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ã™ã‚‹
                const clickableGloss = makeGlossClickable(glossWord);
                
                html += `
                    <div class="word-group">
                        <div class="original-word">${spacedWord}</div>
                        <div class="original-word" style="font-size: 16px; color: #444; font-weight: normal;">${boundaryWord}</div>
                        <div class="gloss-word">${clickableGloss}</div>
                    </div>
                `;
            }
            
            html += '</div>';
            return html;
        }
        
        // ã‚°ãƒ­ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯å¯èƒ½ã«ã™ã‚‹
        function makeGlossClickable(glossText) {
            // ã‚°ãƒ­ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œå‡ºï¼ˆè‹±å­—ã¨ãƒ”ãƒªã‚ªãƒ‰ã®çµ„ã¿åˆã‚ã›ï¼‰
            const glossPattern = /[a-zA-Z]+(\.[a-zA-Z0-9]+)*/g;
            
            return glossText.replace(glossPattern, (match) => {
                // æ—¥æœ¬èªãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯é™¤å¤–
                if (match.match(/[ã-ã‚“ã‚¡-ãƒ¶ãƒ¼ä¸€-é¾¯]/)) {
                    return match;
                }
                return `<span class="gloss-clickable" data-gloss="${match}">${match}</span>`;
            });
        }
        
        // éŸ³å£°ã‚’å†ç”Ÿ
        async function playExample(id) {
            const audio = document.getElementById('audio');
            const exampleItem = document.querySelector(`[data-id="${id}"]`);
            
            if (!audio || !exampleItem) {
                console.error('Audio element or example item not found');
                return;
            }
            
            // æ—¢ã«å†ç”Ÿä¸­ã®å ´åˆã¯åœæ­¢
            if (currentlyPlaying === id && !audio.paused) {
                audio.pause();
                updatePlayingState(null);
                return;
            }
            
            try {
                // å¯¾å¿œã™ã‚‹éŸ³å£°URLã‚’å–å¾—
                const audioUrl = audioUrls[id - 1];
                if (!audioUrl) {
                    throw new Error(`éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ (ä¾‹æ–‡ ${id})`);
                }
                
                console.log(`Playing audio ${id}: ${audioUrl}`);
                
                // éŸ³å£°ã‚’åœæ­¢ã—ã¦ãƒªã‚»ãƒƒãƒˆ
                audio.pause();
                audio.currentTime = 0;
                
                // ç›´æ¥URLã‚’ä½¿ç”¨ï¼ˆCORSãƒ—ãƒ­ã‚­ã‚·ã¯æœ€å¾Œã®æ‰‹æ®µã¨ã—ã¦ï¼‰
                let finalUrl = audioUrl;
                
                // æ–°ã—ã„éŸ³å£°ã‚’ãƒ­ãƒ¼ãƒ‰
                audio.src = finalUrl;
                
                // ãƒ­ãƒ¼ãƒ‰å®Œäº†ã‚’å¾…ã£ã¦ã‹ã‚‰å†ç”Ÿ
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            console.log('Audio playback started successfully');
                            updatePlayingState(id);
                        })
                        .catch(async (error) => {
                            console.error('Initial playback failed:', error);
                            
                            // CORSã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ—ãƒ­ã‚­ã‚·ã‚’è©¦ã™
                            if (error.name === 'NotAllowedError' || error.name === 'NotSupportedError') {
                                console.log('Trying with CORS proxy...');
                                
                                // CORSãƒ—ãƒ­ã‚­ã‚·ã‚’ä½¿ç”¨
                                finalUrl = 'https://corsproxy.io/?' + encodeURIComponent(audioUrl);
                                audio.src = finalUrl;
                                
                                try {
                                    await audio.play();
                                    updatePlayingState(id);
                                    console.log('Playback successful with CORS proxy');
                                } catch (proxyError) {
                                    console.error('CORS proxy also failed:', proxyError);
                                    
                                    // åˆ¥ã®CORSãƒ—ãƒ­ã‚­ã‚·ã‚’è©¦ã™
                                    finalUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(audioUrl);
                                    audio.src = finalUrl;
                                    
                                    try {
                                        await audio.play();
                                        updatePlayingState(id);
                                        console.log('Playback successful with alternative proxy');
                                    } catch (altProxyError) {
                                        console.error('All playback attempts failed:', altProxyError);
                                        showStatus(`éŸ³å£°ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ (ä¾‹æ–‡ ${id})ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`, 'error');
                                    }
                                }
                            }
                        });
                }
                
            } catch (error) {
                console.error('éŸ³å£°å†ç”Ÿã‚¨ãƒ©ãƒ¼:', error);
                showStatus('éŸ³å£°ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'error');
            }
        }
        
        // å…¨ä½“éŸ³å£°ã‚’å†ç”Ÿ
        async function playFullAudio() {
            const audio = document.getElementById('audio');
            const playAllBtn = document.getElementById('playAllBtn');
            
            if (!fullAudioUrl) {
                showStatus('å…¨ä½“éŸ³å£°ã®URLãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
                return;
            }
            
            // æ—¢ã«å†ç”Ÿä¸­ã®å ´åˆã¯åœæ­¢
            if (currentlyPlaying === 'full' && !audio.paused) {
                audio.pause();
                updatePlayingState(null);
                return;
            }
            
            try {
                // éŸ³å£°ã‚’åœæ­¢ã—ã¦ãƒªã‚»ãƒƒãƒˆ
                audio.pause();
                audio.currentTime = 0;
                
                // ç›´æ¥URLã‚’ä½¿ç”¨
                let finalUrl = fullAudioUrl;
                
                console.log('Playing full audio:', finalUrl);
                
                audio.src = finalUrl;
                
                // å†ç”Ÿã‚’è©¦ã¿ã‚‹
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            console.log('Full audio playback started successfully');
                            playAllBtn.classList.add('playing');
                            playAllBtn.querySelector('.button-text').textContent = 'åœæ­¢';
                            playAllBtn.querySelector('.button-icon').textContent = 'â¸';
                            updatePlayingState('full');
                        })
                        .catch(async (error) => {
                            console.error('Full audio playback failed:', error);
                            
                            // CORSã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ãƒ—ãƒ­ã‚­ã‚·ã‚’è©¦ã™
                            if (error.name === 'NotAllowedError' || error.name === 'NotSupportedError') {
                                console.log('Trying with CORS proxy for full audio...');
                                
                                finalUrl = 'https://corsproxy.io/?' + encodeURIComponent(fullAudioUrl);
                                audio.src = finalUrl;
                                
                                try {
                                    await audio.play();
                                    playAllBtn.classList.add('playing');
                                    playAllBtn.querySelector('.button-text').textContent = 'åœæ­¢';
                                    playAllBtn.querySelector('.button-icon').textContent = 'â¸';
                                    updatePlayingState('full');
                                } catch (proxyError) {
                                    console.error('CORS proxy also failed:', proxyError);
                                    showStatus('å…¨ä½“éŸ³å£°ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                                }
                            }
                        });
                }
                
            } catch (error) {
                console.error('å…¨ä½“éŸ³å£°ã®å†ç”Ÿã‚¨ãƒ©ãƒ¼:', error);
                showStatus('å…¨ä½“éŸ³å£°ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message, 'error');
            }
        }
        
        // å†ç”ŸçŠ¶æ…‹ã‚’æ›´æ–°
        function updatePlayingState(id) {
            const audioPlayer = document.getElementById('audioPlayer');
            const currentExample = document.getElementById('currentExample');
            const playAllBtn = document.getElementById('playAllBtn');
            
            // ã™ã¹ã¦ã®ä¾‹æ–‡ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤
            document.querySelectorAll('.example-item').forEach(item => {
                item.classList.remove('playing');
                item.querySelector('.play-icon').textContent = 'â–¶';
            });
            
            // å…¨ä½“éŸ³å£°ãƒœã‚¿ãƒ³ã®ãƒªã‚»ãƒƒãƒˆ
            playAllBtn.classList.remove('playing');
            playAllBtn.querySelector('.button-text').textContent = 'å…¨ä½“éŸ³å£°ã‚’å†ç”Ÿ';
            playAllBtn.querySelector('.button-icon').textContent = 'â–¶';
            
            if (id === 'full') {
                // å…¨ä½“éŸ³å£°å†ç”Ÿä¸­
                currentExample.textContent = 'å…¨ä½“éŸ³å£°';
                audioPlayer.classList.add('active');
                playAllBtn.classList.add('playing');
                playAllBtn.querySelector('.button-text').textContent = 'åœæ­¢';
                playAllBtn.querySelector('.button-icon').textContent = 'â¸';
            } else if (id !== null) {
                // å€‹åˆ¥ä¾‹æ–‡å†ç”Ÿä¸­
                const playingItem = document.querySelector(`[data-id="${id}"]`);
                if (playingItem) {
                    playingItem.classList.add('playing');
                    playingItem.querySelector('.play-icon').textContent = 'â¸';
                }
                currentExample.textContent = `ä¾‹æ–‡ (${id})`;
                audioPlayer.classList.add('active');
            } else {
                // åœæ­¢
                audioPlayer.classList.remove('active');
                document.getElementById('progressBar').style.width = '0%';
            }
            
            currentlyPlaying = id;
        }
        
        // é€²è¡ŒçŠ¶æ³ã‚’æ›´æ–°
        function updateProgress() {
            const audio = document.getElementById('audio');
            const progressBar = document.getElementById('progressBar');
            
            if (audio.duration) {
                const progress = (audio.currentTime / audio.duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
        
        // ã‚°ãƒ­ã‚¹ã®å¹ãå‡ºã—ã‚’è¡¨ç¤º
        async function showGlossTooltip(gloss, element) {
            const tooltip = document.getElementById('glossTooltip');
            const glossTitle = document.getElementById('glossTitle');
            const glossDescription = document.getElementById('glossDescription');
            
            // ã‚°ãƒ­ã‚¹ã®ç¿»è¨³ã‚’å–å¾—
            const translation = await getGlossTranslation(gloss);
            
            glossTitle.textContent = gloss.toUpperCase();
            glossDescription.textContent = translation;
            
            // ä½ç½®ã‚’è¨ˆç®—
            const rect = element.getBoundingClientRect();
            const tooltipWidth = 300;
            let left = rect.left + (rect.width / 2) - (tooltipWidth / 2);
            const top = rect.top - 80;
            
            // ç”»é¢ã‹ã‚‰ã¯ã¿å‡ºãªã„ã‚ˆã†ã«èª¿æ•´
            if (left < 10) left = 10;
            if (left + tooltipWidth > window.innerWidth - 10) {
                left = window.innerWidth - tooltipWidth - 10;
            }
            
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
            tooltip.classList.add('show');
        }
        
        // ã‚°ãƒ­ã‚¹ã®å¹ãå‡ºã—ã‚’éè¡¨ç¤º
        function hideGlossTooltip() {
            const tooltip = document.getElementById('glossTooltip');
            if (tooltip) {
                tooltip.classList.remove('show');
            }
        }
        
        // è¤‡åˆã‚°ãƒ­ã‚¹ã‚’è§£æã—ã¦èª¬æ˜ã‚’ç”Ÿæˆ
        async function getGlossTranslation(gloss) {
            // å†…è”µè¾æ›¸ã‹ã‚‰æ¤œç´¢
            const parts = gloss.toLowerCase().split('.');
            const translations = [];
            let allFound = true;
            
            for (const part of parts) {
                if (glossDictionary[part]) {
                    translations.push(glossDictionary[part]);
                } else if (part.match(/^\d+$/)) {
                    translations.push(part + 'äººç§°');
                } else {
                    // è¾æ›¸ã«è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
                    allFound = false;
                    translations.push(part.toUpperCase());
                }
            }
            
            if (!allFound) {
                // ä¸€ã¤ã§ã‚‚è¦‹ã¤ã‹ã‚‰ãªã„ã‚°ãƒ­ã‚¹ãŒã‚ã£ãŸå ´åˆ
                return 'SearchGlossã«ãªã—';
            }
            
            if (translations.length > 1) {
                return translations.join('ãƒ»');
            } else if (translations.length === 1) {
                return translations[0];
            } else {
                return 'SearchGlossã«ãªã—';
            }
        }
        
        // SearchGlossã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆç¾åœ¨ã¯ä½¿ç”¨ã—ãªã„ï¼‰
        async function fetchFromSearchGloss(gloss) {
            // å°†æ¥çš„ã«ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã®SearchGlossã¨é€£æºã™ã‚‹å ´åˆã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
            return null;
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        function showStatus(message, type = 'info') {
            const statusMessage = document.getElementById('statusMessage');
            statusMessage.textContent = message;
            statusMessage.className = 'status-message ' + type;
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusMessage.className = 'status-message';
                }, 5000);
            }
        }
        
        // HTMLã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadHTML() {
            // ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã®HTMLã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
            const htmlClone = document.documentElement.cloneNode(true);
            
            // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤
            const uploadSection = htmlClone.querySelector('#uploadSection');
            if (uploadSection) {
                uploadSection.remove();
            }
            
            ytLinks.forEach(el => el.remove());
            
            // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
            const contentSection = htmlClone.querySelector('#contentSection');
            if (contentSection) {
                contentSection.style.display = 'block';
            }
            
            // ä¾‹æ–‡ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ï¼ˆJavaScriptã§å†ç”Ÿæˆã™ã‚‹ãŸã‚ï¼‰
            const exampleList = htmlClone.querySelector('#exampleList');
            if (exampleList) {
                exampleList.innerHTML = '';
            }
            
            // ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã‚’æ¢ã™
            const scripts = htmlClone.getElementsByTagName('script');
            let mainScript = null;
            
            for (let script of scripts) {
                if (script.textContent.includes('let examples = []')) {
                    mainScript = script;
                    break;
                }
            }
            
            if (mainScript) {
                // ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã‚€ãŸã‚ã®æ–°ã—ã„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ
                const dataScript = document.createElement('script');
                dataScript.textContent = `
                    // åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿
                    window.embeddedData = {
                        examples: ${JSON.stringify(examples)},
                        audioUrls: ${JSON.stringify(audioUrls)},
                        fullAudioUrl: ${JSON.stringify(fullAudioUrl)}
                    };
                `;
                
                // ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‰ã«ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŒ¿å…¥
                mainScript.parentNode.insertBefore(dataScript, mainScript);
                
                // ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…å®¹ã‚’ä¿®æ­£
                let scriptContent = mainScript.textContent;
                
                // processFilesé–¢æ•°ã‚’ä¿®æ­£ï¼ˆåŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰
                const modifiedProcessFiles = `
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ï¼ˆåŸ‹ã‚è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ç‰ˆï¼‰
        async function processFiles() {
            // åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
            if (window.embeddedData) {
                examples = window.embeddedData.examples;
                audioUrls = window.embeddedData.audioUrls;
                fullAudioUrl = window.embeddedData.fullAudioUrl;
                
                console.log('åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™');
                console.log(\`ä¾‹æ–‡æ•°: \${examples.length}\`);
                console.log(\`éŸ³å£°URLæ•°: \${audioUrls.length}\`);
                
                // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
                displayContent();
                
                // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
                const uploadSection = document.getElementById('uploadSection');
                if (uploadSection) {
                    uploadSection.style.display = 'none';
                }
                document.getElementById('contentSection').style.display = 'block';
                
                return;
            }
            
            // å…ƒã®processFilesé–¢æ•°ã®ã‚³ãƒ¼ãƒ‰
            `;
                
                // processFilesé–¢æ•°ã‚’ç½®ãæ›ãˆ
                scriptContent = scriptContent.replace(
                    /async function processFiles\(\) {/,
                    modifiedProcessFiles
                );
                
                // DOMContentLoadedæ™‚ã«åŸ‹ã‚è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
                const initCode = `
        // DOMã®èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            
            // åŸ‹ã‚è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯è‡ªå‹•çš„ã«å‡¦ç†
            if (window.embeddedData) {
                processFiles();
            }
        });`;
                
                scriptContent = scriptContent.replace(
                    /\/\/ DOMã®èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸåŒ–[\s\S]*?}\);/,
                    initCode
                );
                
                mainScript.textContent = scriptContent;
            }
            
            // HTMLã‚’æ–‡å­—åˆ—ã«å¤‰æ›
            let htmlContent = '<!DOCTYPE html>\n' + htmlClone.outerHTML;
            
            htmlContent = htmlContent.split('\n').filter(line => {
            }).join('\n');
            
            // Blobã‚’ä½œæˆ
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            
            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã‚’ä½œæˆ
            const downloadLink = document.createElement('a');
            downloadLink.href = URL.createObjectURL(blob);
            
            // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’è¨­å®šï¼ˆã‚¿ã‚¤ãƒˆãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã‚Œã‚’ä½¿ç”¨ï¼‰
            const pageTitle = document.getElementById('pageTitle').textContent;
            const fileName = pageTitle !== 'ã‚°ãƒ­ã‚¹ä»˜ããƒ†ã‚­ã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼ã‚¢' 
                ? `${pageTitle}.html` 
                : 'intex_output.html';
            
            downloadLink.download = fileName;
            
            // ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹
            document.body.appendChild(downloadLink);
            downloadLink.click();
            document.body.removeChild(downloadLink);
            
            // ãƒ¡ãƒ¢ãƒªã‚’è§£æ”¾
            URL.revokeObjectURL(downloadLink.href);
            
            showStatus('HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'success');
        }
    </script>


</body></html>
